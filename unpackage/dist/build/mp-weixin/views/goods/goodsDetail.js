require('./common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["views/goods/goodsDetail"],{"0074":function(e,o,n){"use strict";var t=n("ceb6"),s=n.n(t);s.a},"0786":function(e,o,n){"use strict";n.r(o);var t=n("b778"),s=n.n(t);for(var i in t)"default"!==i&&function(e){n.d(o,e,(function(){return t[e]}))}(i);o["default"]=s.a},"1fa8":function(e,o,n){"use strict";(function(e){n("3d3f");t(n("66fd"));var o=t(n("f75a"));function t(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("543d")["createPage"])},b778:function(e,o,n){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t=a(n("a34a")),s=a(n("bd0e")),i=n("b075");function a(e){return e&&e.__esModule?e:{default:e}}function r(e,o,n,t,s,i,a){try{var r=e[i](a),c=r.value}catch(u){return void n(u)}r.done?o(c):Promise.resolve(c).then(t,s)}function c(e){return function(){var o=this,n=arguments;return new Promise((function(t,s){var i=e.apply(o,n);function a(e){r(i,t,s,a,c,"next",e)}function c(e){r(i,t,s,a,c,"throw",e)}a(void 0)}))}}var u={data:function(){return{bigImage:"",pwd:"",size:"S【建议100斤以内】",number:1,show:!1,sizeList:[{title:"S【建议100斤以内】"},{title:"M【建议100-115斤】"},{title:"L【建议115-130斤】"},{title:"XL【建议130-140斤】"},{title:"XXL【建议140-160斤】"}],addressInfo:[],Itemindex:0,Sizeindex:0,choose:"",goodsImg:"",canvasImg:"",qrcodeImg:"",content:"",textImg:"",change:!1,goodsInfo:[],list:[],timeData:{},time:"",note:"",btnList:[{icon:"/static/goodsDetail/store.png",name:"店铺"},{icon:"/static/goodsDetail/car.png",name:"购物车"}],tagList:[{tag:"购买得积分"},{tag:"首单免邮"},{tag:"七天无理由退换"}]}},onReady:function(){this.createQrcode()},onShow:function(){},onLoad:function(o){this.getDetail(o.goodsId);var n=e.getStorageSync("address");console.log("addressList",n),n.length>0&&n[0].isDefaultAddress&&(this.addressInfo=n[0])},methods:{tapImg:function(e){this.bigImage=this.list[e]},addCard:function(){if(e.getStorageSync("nickname"))if(e.getStorageSync("cardList")){var o=e.getStorageSync("cardList"),n={goodsName:this.goodsInfo.goodsName,goodsPrice:this.goodsInfo.salePrice,goodsStore:this.goodsInfo.storeName,goodsImg:this.goodsInfo.goodsImg,size:this.size,remark:this.note,number:this.number,rank:this.goodsInfo.rank,discount:this.goodsInfo.discount};o.push(n),e.setStorageSync("cardList",o),e.$showMsg("加入购物车成功","none",2e3),this.$refs.selectItem.close()}else{var t=[],s={goodsName:this.goodsInfo.goodsName,goodsPrice:this.goodsInfo.salePrice,goodsStore:this.goodsInfo.storeName,goodsImg:this.goodsInfo.goodsImg,size:this.size,remark:this.note,number:this.number,rank:this.goodsInfo.rank,discount:this.goodsInfo.discount};t.push(s),e.setStorageSync("cardList",t),e.$showMsg("加入购物车成功！","none",2e3),this.$refs.selectItem.close()}else e.switchTab({url:"/pages/my/my"})},descNumber:function(){this.number<=1?e.$showMsg("不能再少了","none",2e3):this.number--},PAY:function(){e.$showMsg("暂不支持其他方式支付！","none",2e3)},finish:function(o){var n=this;setTimeout((function(){n.show=!1;var o=e.getStorageSync("orderList");e.request({url:"/api/order",data:{order:o[o.length-1]},success:function(n){var t=[];t=n.data,console.log("orderData",t),o[o.length-1].type="success",console.log("order",o),e.setStorageSync("orderList",o),e.hideLoading(),e.navigateTo({url:"/views/goods/paySuccess?orderData="+JSON.stringify(t)})}})}),1e3),e.showLoading({title:"支付中..."})},addNumber:function(){this.number++},toAddress:function(){e.navigateTo({url:"/views/address/address"})},pay:function(){var o=this;if(this.addressInfo.name&&this.addressInfo.phoneNumber&&this.addressInfo.address){var n={goodsName:this.goodsInfo.goodsName,goodsPrice:this.goodsInfo.salePrice,goodsStore:this.goodsInfo.storeName,goodsImg:this.goodsInfo.goodsImg,address:this.addressInfo.address+this.addressInfo.addArea,name:this.addressInfo.name,size:this.size,number:this.number,time:(new Date).getTime(),remark:this.note,phone:this.addressInfo.phoneNumber};if(e.getStorageSync("orderList")){var t=e.getStorageSync("orderList");t.push(n),e.setStorageSync("orderList",t)}else{var s=[];s.push(n),e.setStorageSync("orderList",s)}setTimeout((function(){o.show=!0,e.hideLoading()}),1e3),e.showLoading({title:"支付中..."})}else e.$showMsg("请完善收货地址信息！","none",2e3)},close:function(){this.show=!1,e.$showMsg("您已取消了支付","none",2e3)},openselectItem:function(o){e.getStorageSync("nickname")?"buy"==o?(this.$refs.selectItem.open(),this.choose="buy"):(this.$refs.selectItem.open(),this.choose="add"):e.switchTab({url:"/pages/my/my"})},chooseSize:function(e,o){this.Sizeindex=o,this.size=e.title},chooseItem:function(e,o){this.goodsInfo.goodsImg=e,this.Itemindex=o},closeselectItem:function(){this.$refs.selectItem.close()},goWhere:function(o){e.getStorageSync("nickname")?"店铺"==o.name?e.$showMsg("查看店铺功能开发中...","none",2e3):"购物车"==o.name&&e.switchTab({url:"/pages/car/car"}):e.switchTab({url:"/pages/my/my"})},showDialog:function(){e.getStorageSync("nickname")?this.$refs.share.open():e.switchTab({url:"/pages/my/my"})},hideDialog:function(){this.$refs.share.close()},getDetail:function(o){var n=this;e.request({url:"/api/goodsDetail",data:{goodsId:Number(o)},success:function(e){if(200==e.data.code)for(var o in n.goodsInfo=e.data.goodsDetail,console.log(n.goodsInfo,"this.goodsInfo"),n.goodsImg=n.goodsInfo.goodsImg,n.time=1e3*n.goodsInfo.expirationTime-Number((new Date).getTime()),e.data.goodsDetail.goodsDetail)n.list.push(e.data.goodsDetail.goodsDetail[o].img)}})},removebigImage:function(){this.bigImage=""},changeIcon:function(){e.getStorageSync("nickname")?(this.change=!this.change,e.$showMsg("".concat(this.change?"收藏成功":"已取消收藏"),"none",2e3)):e.switchTab({url:"/pages/my/my"})},onChange:function(e){this.timeData=e},createGoodsPoster:function(){var o=this;return c(t.default.mark((function n(){var i,a,r,c,u,d,g,l,f,m;return t.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o.hideDialog(),!o.canvasImg){n.next=3;break}return n.abrupt("return");case 3:return i=o,e.showLoading({title:"海报生成中"}),a=600,r=730,c=400,u=100,d=30,g=" 'PingFang SC',tahoma,arial,'helvetica neue','hiragino sans gb','microsoft yahei',sans-serif",l=e.createCanvasContext("firstCanvas"),s.default.fillRoundRect(l,0,0,a,r,20,"#ffffff"),n.next=15,s.default.getImageInfo(i.goodsImg);case 15:f=n.sent,f.path?(l.save(),l.clip(),s.default.drawImgCover(l,f,0,0,a,c),l.restore(),l.font="22px"+g,s.default.drawButton(l,"red",65,418,170,52,16,"会员价:".concat(o.goodsInfo.salePrice),"#ffffff","center"),l.setFillStyle("#666666"),l.textAlign="left",m={font:"normal 26px"+g,ctx:l,word:i.goodsInfo.goodsName,maxWidth:540,maxLine:2,x:d,y:450,l_h:40},s.default.dealWords(m),s.default.drawCircular(l,f.path,d,c+d+160,u,u),l.setFillStyle("#000000"),l.font="bold 26px"+g,l.fillText("".concat(e.getStorageSync("nickname")," 为您推荐"),u+d+10,c+d+195),l.setFillStyle("#999999"),l.font="normal 22px"+g,l.fillText("快来和我一起看看吧！",u+d+10,c+d+235),l.drawImage(i.qrcodeImg,a-d-150,c+d+80+50,150,150),l.draw(!1,(function(){e.canvasToTempFilePath({width:a,height:r,canvasId:"firstCanvas",success:function(o){e.hideLoading(),i.canvasImg=o.tempFilePath}},i)}),500)):(e.hideLoading(),e.showToast({title:"海报制作失败",icon:"none"}));case 17:case"end":return n.stop()}}),n)})))()},onSaveImg:function(){var e=this;return c(t.default.mark((function o(){var n;return t.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n="",!e.canvasImg){o.next=6;break}return o.next=4,e.canvasImg;case 4:n=o.sent,(0,i.saveImg)(n);case 6:case"end":return o.stop()}}),o)})))()},onExitImg:function(){this.canvasImg=""},createQrcode:function(){var o=this;(0,i.qrcodeCanvas)("qrcode","https://www.baidu.com",600,600);var n=e.createCanvasContext("qrcode");n.draw(!0,(function(){e.canvasToTempFilePath({width:600,height:600,canvasId:"qrcode",success:function(e){o.qrcodeImg=e.tempFilePath}},o)}))}}};o.default=u}).call(this,n("543d")["default"])},c8aa:function(e,o,n){"use strict";n.d(o,"b",(function(){return s})),n.d(o,"c",(function(){return i})),n.d(o,"a",(function(){return t}));var t={uSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(n.bind(null,"5c79"))},uCountDown:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-count-down/u-count-down")]).then(n.bind(null,"0898"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"abe3"))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"ffb0"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"36f0"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"d3cd"))},uCodeInput:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-code-input/u-code-input")]).then(n.bind(null,"bee0"))}},s=function(){var e=this,o=e.$createElement,n=(e._self._c,e.bigImage?null:Number(e.goodsInfo.salePrice).toFixed(2)),t=e.bigImage?null:Number(e.goodsInfo.marketPrice*e.number).toFixed(2),s=e.bigImage?null:Number(e.goodsInfo.salePrice*e.number).toFixed(2),i=e.bigImage||"add"==e.choose?null:Number(e.goodsInfo.salePrice*e.number).toFixed(2),a=e.bigImage?null:Number(e.goodsInfo.salePrice*e.number).toFixed(2);e.$mp.data=Object.assign({},{$root:{g0:n,g1:t,g2:s,g3:i,g4:a}})},i=[]},ceb6:function(e,o,n){},f75a:function(e,o,n){"use strict";n.r(o);var t=n("c8aa"),s=n("0786");for(var i in s)"default"!==i&&function(e){n.d(o,e,(function(){return s[e]}))}(i);n("0074");var a,r=n("f0c5"),c=Object(r["a"])(s["default"],t["b"],t["c"],!1,null,"2544b87c",null,!1,t["a"],a);o["default"]=c.exports}},[["1fa8","common/runtime","common/vendor","views/goods/common/vendor"]]]);