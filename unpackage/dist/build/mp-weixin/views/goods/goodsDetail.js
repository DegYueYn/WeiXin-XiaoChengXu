(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["views/goods/goodsDetail"],{"0786":function(e,t,n){"use strict";n.r(t);var o=n("b778"),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"129d":function(e,t,n){"use strict";var o=n("9c65"),a=n.n(o);a.a},"1fa8":function(e,t,n){"use strict";(function(e){n("3d3f");o(n("66fd"));var t=o(n("f75a"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"9c65":function(e,t,n){},b778:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("a34a")),a=r(n("bd0e")),i=n("b075");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,o,a,i,r){try{var c=e[i](r),u=c.value}catch(s){return void n(s)}c.done?t(u):Promise.resolve(u).then(o,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function r(e){c(i,o,a,r,u,"next",e)}function u(e){c(i,o,a,r,u,"throw",e)}r(void 0)}))}}var s={data:function(){return{goodsImg:"",canvasImg:"",qrcodeImg:"",content:"",textImg:"",change:!1,goodsInfo:[],list:[],timeData:{},time:"",tagList:[{tag:"购买得积分"},{tag:"首单免邮"},{tag:"七天无理由退换"}]}},onReady:function(){this.createQrcode()},onLoad:function(e){this.getDetail(e.goodsId)},methods:{createGoodsPoster:function(){var t=this;return u(o.default.mark((function n(){var i,r,c,u,s,d,f,l,g,m;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.hideDialog(),!t.canvasImg){n.next=3;break}return n.abrupt("return");case 3:return i=t,e.showLoading({title:"海报生成中"}),r=600,c=730,u=400,s=100,d=30,f=" 'PingFang SC',tahoma,arial,'helvetica neue','hiragino sans gb','microsoft yahei',sans-serif",l=e.createCanvasContext("firstCanvas"),a.default.fillRoundRect(l,0,0,r,c,20,"#ffffff"),n.next=15,a.default.getImageInfo(i.goodsImg);case 15:g=n.sent,g.path?(l.save(),l.clip(),a.default.drawImgCover(l,g,0,0,r,u),l.restore(),l.font="22px"+f,a.default.drawButton(l,"red",65,418,170,52,16,"会员价:".concat(t.goodsInfo.salePrice),"#ffffff","center"),l.setFillStyle("#666666"),l.textAlign="left",m={font:"normal 26px"+f,ctx:l,word:i.goodsInfo.goodsName,maxWidth:540,maxLine:2,x:d,y:450,l_h:40},a.default.dealWords(m),a.default.drawCircular(l,g.path,d,u+d+160,s,s),l.setFillStyle("#000000"),l.font="bold 26px"+f,l.fillText("".concat(e.getStorageSync("nickname")," 为您推荐"),s+d+10,u+d+195),l.setFillStyle("#999999"),l.font="normal 22px"+f,l.fillText("快来和我一起看看吧！",s+d+10,u+d+235),l.drawImage(i.qrcodeImg,r-d-150,u+d+80+50,150,150),l.draw(!1,(function(){e.canvasToTempFilePath({width:r,height:c,canvasId:"firstCanvas",success:function(t){e.hideLoading(),i.canvasImg=t.tempFilePath}},i)}),500)):(e.hideLoading(),e.showToast({title:"海报制作失败",icon:"none"}));case 17:case"end":return n.stop()}}),n)})))()},onSaveImg:function(){var e=this;return u(o.default.mark((function t(){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="",!e.canvasImg){t.next=6;break}return t.next=4,e.canvasImg;case 4:n=t.sent,(0,i.saveImg)(n);case 6:case"end":return t.stop()}}),t)})))()},onExitImg:function(){this.canvasImg=""},createQrcode:function(){var t=this;(0,i.qrcodeCanvas)("qrcode","https://www.baidu.com",600,600);var n=e.createCanvasContext("qrcode");n.draw(!0,(function(){e.canvasToTempFilePath({width:600,height:600,canvasId:"qrcode",success:function(e){t.qrcodeImg=e.tempFilePath}},t)}))},showDialog:function(){this.$refs.share.open()},hideDialog:function(){this.$refs.share.close()},getDetail:function(t){var n=this;e.request({url:"/api/goodsDetail",data:{goodsId:Number(t)},success:function(e){if(console.log(e.data.goodsDetail),200==e.data.code)for(var t in n.goodsInfo=e.data.goodsDetail,n.goodsImg=n.goodsInfo.goodsImg,n.time=1e3*n.goodsInfo.expirationTime-Number((new Date).getTime()),e.data.goodsDetail.goodsDetail)n.list.push(e.data.goodsDetail.goodsDetail[t].img)}})},changeIcon:function(){this.change=!this.change,e.$showMsg("".concat(this.change?"收藏成功":"已取消收藏"),"none",2e3)},onChange:function(e){this.timeData=e}}};t.default=s}).call(this,n("543d")["default"])},d750:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(n.bind(null,"5c79"))},uCountDown:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-count-down/u-count-down")]).then(n.bind(null,"0898"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"abe3"))}},a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.goodsInfo.salePrice.toFixed(2));e.$mp.data=Object.assign({},{$root:{g0:n}})},i=[]},f75a:function(e,t,n){"use strict";n.r(t);var o=n("d750"),a=n("0786");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("129d");var r,c=n("f0c5"),u=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,"29cb00dd",null,!1,o["a"],r);t["default"]=u.exports}},[["1fa8","common/runtime","common/vendor"]]]);